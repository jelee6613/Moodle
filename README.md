# MOODLE, ë‹¹ì‹ ë§Œì˜ ì˜í™” ê°ë…ì„ ì°¾ì•„ë³´ì„¸ìš”!

- ì‚¼ì„± ì²­ë…„ SWì•„ì¹´ë°ë¯¸ ê´€í†µí”„ë¡œì íŠ¸ ìµœìš°ìˆ˜ìƒğŸ†
- 2022ë…„ 5ì›” 17ì¼ ~ 2022ë…„ 5ì›” 26ì¼


![MOODLE.png](assets/ë©”ì¸.png)

## ëª©ì°¨

1ï¸âƒ£ <a href="#1ï¸âƒ£-ê°œìš”">ê°œìš”</a>

2ï¸âƒ£ <a href="#2ï¸âƒ£-ê¸°ìˆ ìŠ¤íƒ--ê¸°ì—¬ë„">ê¸°ìˆ ìŠ¤íƒ & ê¸°ì—¬ë„</a>

3ï¸âƒ£ <a href="#3ï¸âƒ£-ì„¤ê³„">ì„¤ê³„</a>

4ï¸âƒ£ <a href="#4ï¸âƒ£-ì‹œì—°">ì‹œì—°</a>

5ï¸âƒ£ <a href="#5ï¸âƒ£-ê°œë°œì">ê°œë°œì</a>

6ï¸âƒ£ <a href="#6ï¸âƒ£-íšŒê³ ">íšŒê³ </a>


<br>

## 1ï¸âƒ£ ê°œìš”

- TMDB APIë¥¼ ì´ìš©í•´ ì˜í™” ì •ë³´ë¥¼ ë¶ˆëŸ¬ì™€ ì˜í™” ë°ì´í„°ë¥¼ ì‚¬ìš©ìì—ê²Œ ë³´ì—¬ì£¼ê³  ì¶”ì²œë„ í•´ì¤˜ìš”!
- ê°„ë‹¨í•œ í€´ì¦ˆë¥¼ ì½ê³  í•´ë‹¹í•˜ëŠ” ë³´ê¸°ë¥¼ ê³ ë¥´ë©´ ë‹¹ì‹ ê³¼ ë¹„ìŠ·í•œ ì„±í–¥ì˜ ê°ë…ì„ ì°¾ì•„ë“œë¦½ë‹ˆë‹¤!
- ë‚˜ì™€ ê°€ì¥ ë‹®ì€ ê°ë…ì˜ ì˜í™” ì¤‘ ë‚´ ì·¨í–¥ì— ë”± ë§ëŠ” ì˜í™”ë¥¼ ì¶”ì²œí•´ë“œë ¤ìš”!
- ì¶”ì²œ ë°›ì€ ì˜í™”ë¥¼ ê°ìƒí•˜ë©´ ì»¤ë®¤ë‹ˆí‹°ì—ì„œ ë‹¤ë¥¸ ì‚¬ëŒê³¼ í•¨ê»˜ ì˜í™”ì— ëŒ€í•œ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ ë³´ì„¸ìš”~

<br>

## 2ï¸âƒ£ ê¸°ìˆ ìŠ¤íƒ & ê¸°ì—¬ë„

### ğŸ”¸ ê¸°ìˆ ìŠ¤íƒ

<span>
<img src="https://img.shields.io/badge/Python-3776AB?style=for-the-badge&logo=Python&logoColor=white">
<img src="https://img.shields.io/badge/Django-000000?style=for-the-badge&logo=Django&logoColor=white">
<img src="https://img.shields.io/badge/sqlite-003B57?style=for-the-badge&logo=sqlite&logoColor=white">
</span>
<br>
<span>
<img src="https://img.shields.io/badge/javascript-F7DF1E?style=for-the-badge&logo=javascript&logoColor=black">
<img src="https://img.shields.io/badge/vue.js-4FC08D?style=for-the-badge&logo=vue.js&logoColor=white">
<img src="https://img.shields.io/badge/Node.js-339939?style=for-the-badge&logo=Node.js&logoColor=white">
</span>
<br>
<span>
<img src="https://img.shields.io/badge/html5-E34F26?style=for-the-badge&logo=html5&logoColor=white">
<img src="https://img.shields.io/badge/css3-1572B6?style=for-the-badge&logo=css3&logoColor=white">
<img src="https://img.shields.io/badge/bootstrap-7952B3?style=for-the-badge&logo=bootstrap&logoColor=white">
</span>
<br>
<span>
<img src="https://img.shields.io/badge/GitLab-FCA121?style=for-the-badge&logo=GitLab&logoColor=white">
<img src="https://img.shields.io/badge/Mattermost-0058CC?style=for-the-badge&logo=Mattermost&logoColor=white">
</span>
<br>
<span>
<img src="https://img.shields.io/badge/visual studio code-007ACC?style=for-the-badge&logo=visualstudiocode&logoColor=white">
</span>

<br>

### ğŸ”¸ ê¸°ì—¬ë„ (Back-End)

<span>
<img src="https://img.shields.io/badge/Python-3776AB?style=for-the-badge&logo=Python&logoColor=white">
<img src="https://img.shields.io/badge/Django-000000?style=for-the-badge&logo=Django&logoColor=white">
<img src="https://img.shields.io/badge/sqlite-003B57?style=for-the-badge&logo=sqlite&logoColor=white">
</span>

<br>

<span>
<img src="https://img.shields.io/badge/GitLab-FCA121?style=for-the-badge&logo=GitLab&logoColor=white">
<img src="https://img.shields.io/badge/Mattermost-0058CC?style=for-the-badge&logo=Mattermost&logoColor=white">
</span>

<br>

<span>
<img src="https://img.shields.io/badge/visual studio code-007ACC?style=for-the-badge&logo=visualstudiocode&logoColor=white">
</span>

#### â—¼ ê¸°íš

#### â—¼ ì„¤ê³„

â—½ ERD ì‘ì„±

â—½ Components ì„¤ê³„

â—½ Routes ì„¤ê³„

#### â—¼ ê°œë°œ

â—½ REST API êµ¬ì¶•

â—½ Open API í™œìš©

â—½ DB ê´€ë¦¬

â—½ ì˜í™” ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜

<br>

## 3ï¸âƒ£ ì„¤ê³„

### ğŸ”¸ ERD

![erd](assets/erd.png)

### ğŸ”¸ Components & Routes êµ¬ì¡°

![front](assets/front.png)

<br>

## 4ï¸âƒ£ ì‹œì—°

### ğŸ‘‡Click!

[![ì‹œì—°ì˜ìƒ](assets/ë¡œê³ .png)](https://youtu.be/ALXX5F6ty6w) 

0:00 - ë©”ì¸í˜ì´ì§€ & ìƒì„¸í˜ì´ì§€

0:18 - ë¡œê·¸ì¸

0:25 - ì˜í™” í‰ì  ê¸°ëŠ¥

0:44 - í”„ë¡œí•„ í™”ë©´

0:56 - íšŒì›ê°€ì…

1:08 - ì‚¬ìš©ìë“¤ì˜ í‰ê·  í‰ì  ì œê³µ

1:26 - ì»¤ë®¤ë‹ˆí‹° ê¸°ëŠ¥

2:13 - íŒ”ë¡œìš° ê¸°ëŠ¥

2:17 - ì˜í™” ì¶”ì²œ ì„œë¹„ìŠ¤ ê¸°ëŠ¥

<br>

## 5ï¸âƒ£ ê°œë°œì

| ì´ë¦„ | ì—­í•  |
| --- | --- |
| ğŸ‘©ë§ˆì£¼ë¦¬ | Front-End |
| ğŸ‘¨ì´ì¢…ì€ (me) | Back-End |

<br>

## 6ï¸âƒ£ íšŒê³ 

### ğŸ”¸ í•µì‹¬ê¸°ëŠ¥

<details>
  <summary><h4>TMDB APIë¡œ ë°›ì•„ì˜¨ ì˜í™” ì •ë³´ DBì— ì €ì¥í•˜ê¸°</h4></summary>
  
```python
    genres_dict = {
        28: 'ì•¡ì…˜',
        12: 'ëª¨í—˜',
        16: 'ì• ë‹ˆë©”ì´ì…˜',
        35: 'ì½”ë¯¸ë””',
        80: 'ë²”ì£„',
        99: 'ë‹¤íë©˜í„°ë¦¬',
        18: 'ë“œë¼ë§ˆ',
        10751: 'ê°€ì¡±',
        14: 'íŒíƒ€ì§€',
        36: 'ì—­ì‚¬',
        27: 'ê³µí¬',
        10402: 'ìŒì•…',
        9648: 'ë¯¸ìŠ¤í…Œë¦¬',
        10749: 'ë¡œë§¨ìŠ¤',
        878: 'SF',
        53: 'ìŠ¤ë¦´ëŸ¬',
        10752: 'ì „ìŸ',
        37: 'ì„œë¶€',
    }
    
    @api_view(['GET'])
    @permission_classes([AllowAny])
    def movie_list(request):
    
        URL = 'https://api.themoviedb.org/3'  
        api_key = 'ë°œê¸‰ ë°›ì€ API_KEY'
        params = {
            'api_key': api_key,
            'language': 'ko-KR',
            'region': 'KR',
        }
    
        GET_MOVIES_PATHS_DICT = {
            'now_playing': '/movie/now_playing',
            'upcoming': '/movie/upcoming',
            'popular': '/movie/popular',
        }
    
        res = {}
    
        for GET_MOVIES_PATH_NAME, GET_MOVIES_PATH in GET_MOVIES_PATHS_DICT.items():
            response_movies = requests.get(URL+GET_MOVIES_PATH, params=params)
            response_movies_json = response_movies.json()
            movies_data = response_movies_json['results']
    
            movies = []
            for movie_data in movies_data:
    
                serializer = MovieValidationSerializer(data=movie_data)
                if serializer.is_valid():
                    if not Movie.objects.filter(title=movie_data['title']).exists():
                    
                        # ì¥ë¥´ id => í•œê¸€í™” ì‘ì—…
                        genres_datas = movie_data['genre_ids']
                        movie_genres = []
                        for genre_data in genres_datas:
                            if genres_dict[genre_data]:
                                movie_genres.append(genres_dict[genre_data])
                        
                        # listê°ì²´ JSONí™” => ì¶”í›„ í•„ë“œì— ì €ì¥ & íŒŒì‹±í•´ì„œ ì‚¬ìš©
                        movie_genres_json = json.dumps(movie_genres)
    
                        # movieì˜ idê°’ìœ¼ë¡œ TMDB credits path ìš”ì²­í•´ì„œ ê°ë… ì´ë¦„ êµ¬í•˜ê¸°
                        GET_CREDITS_PATH = f'/movie/{movie_data["id"]}/credits'
                        response_credits = requests.get(URL+GET_CREDITS_PATH, params=params)
                        response_credits_json = response_credits.json()
    
                        # ì˜í™” ì œì‘ì ëª…ë‹¨ì¸ creditsì˜ ì†ì„± crewì˜ ê°’ì„ ë³€ìˆ˜í™” => crews_data
                        crews_data = response_credits_json['crew']
    
                        # ì§ì±…ì´ Directingì¸ crewì˜ ì´ë¦„ì„ director í•„ë“œì— ì €ì¥
                        for crew_data in crews_data:
                            if crew_data['department'] == 'Directing':
                                movie_director = crew_data['name']
                                break
                        
                        serializer.save(genre=movie_genres_json, director=movie_director)
        
                    movie = get_object_or_404(Movie, title=movie_data['title'])
                    serializer = MovieDetailSerializer(movie)
                    movies.append(serializer.data)
            
    				# í˜„ì¬ìƒì˜ì‘, ê°œë´‰ì˜ˆì •, ì¸ê¸°ì‘ì´ ë‹´ê¸´ ë”•ì…”ë„ˆë¦¬ ìš”ì†Œ 3ê°œê°€ ë‹´ê²¨ì„œ í•œ ë²ˆì— ì‘ë‹µ
            res[GET_MOVIES_PATH_NAME] = movies
    
        return Response(res)
        
```
    
</details>

<details>
  <summary><h4>ì‚¬ìš©ìê°€ ì œì¶œí•œ ì„¤ë¬¸ ê²°ê³¼ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¹„ìŠ·í•œ ì„±í–¥ì˜ ì˜í™” ê°ë… ì°¾ê¸°</h4></summary>
  
```python
@api_view(['GET', 'POST'])
    def movie_recommendations(request):
    		
    		# í€´ì¦ˆë¥¼ ì§„í–‰í•˜ê¸° ìœ„í•œ ë¬¸í•­&ë³´ê¸° ì‘ë‹µ
        if request.method == 'GET':
            quizzes = Question.objects.all()
            serializer = QuestionSerializer(quizzes, many=True)
            return Response(serializer.data)
    		
    		# ì œì¶œí•œ í€´ì¦ˆ ê²°ê³¼ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¹„ìŠ·í•œ ì„±í–¥ì˜ ì˜í™” ê°ë… ì°¾ê¸°
        elif request.method == 'POST':
            # results = request.data['results']
            
            results = []
            for value_id in request.data:
                value = get_object_or_404(Value, id=value_id)
                results.append(value.director)
    
            recommendable_director = max(set(results), key=results.count)
            director_movies = Movie.objects.all().filter(director=recommendable_director)
```
    
</details>

<details>
  <summary><h4>ë¹„ìŠ·í•œ ì„±í–¥ì˜ ì˜í™” ê°ë… ì‘í’ˆ ì¤‘ì—ì„œ ì‚¬ìš©ìê°€ ë§ì´ ë³¸ ì¥ë¥´ì˜ ì˜í™” ì¶”ì²œí•˜ê¸°</h4></summary>
  
```python
@api_view(['GET', 'POST'])
def movie_recommendations(request):

        # í€´ì¦ˆë¥¼ ì§„í–‰í•˜ê¸° ìœ„í•œ ë¬¸í•­&ë³´ê¸° ì‘ë‹µ
    if request.method == 'GET':

                # ...

        # ì œì¶œí•œ í€´ì¦ˆ ê²°ê³¼ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¹„ìŠ·í•œ ì„±í–¥ì˜ ì˜í™” ê°ë… ì°¾ê¸°
    elif request.method == 'POST':

                # ...

                user_genres = {
                    'ì•¡ì…˜': 0,
                    'ëª¨í—˜': 0,
                    'ì• ë‹ˆë©”ì´ì…˜': 0,
                    'ì½”ë¯¸ë””': 0,
                    'ë²”ì£„': 0,
                    'ë‹¤íë©˜í„°ë¦¬': 0,
                    'ë“œë¼ë§ˆ': 0,
                    'ê°€ì¡±': 0,
                    'íŒíƒ€ì§€': 0,
                    'ì—­ì‚¬': 0,
                    'ê³µí¬': 0,
                    'ìŒì•…': 0,
                    'ë¯¸ìŠ¤í…Œë¦¬': 0,
                    'ë¡œë§¨ìŠ¤': 0,
                    'SF': 0,
                    'ìŠ¤ë¦´ëŸ¬': 0,
                    'ì „ìŸ': 0,
                    'ì„œë¶€': 0,
                }

                # JSON íŒŒì‹±ë„êµ¬
                jsonDec = json.decoder.JSONDecoder()

                movies = request.user.movies.all()

                # ì‚¬ìš©ìê°€ ë³¸ ì˜í™”ë¥¼ ìˆœíšŒ => ê° ì˜í™”ì˜ ì¥ë¥´ë¥¼ íŒŒì‹± => user_genresì— ì¹´ìš´íŠ¸
                for movie in movies:
                    genres = jsonDec.decode(movie.genre)
                    for genre in genres:
                        user_genres[genre] += 1

                # user_genresì˜ valueê°€ ìˆëŠ” ê°’ë§Œ(ì‚¬ìš©ìê°€ ë³¸ ì¥ë¥´ë§Œ) íŠœí”Œ í˜•íƒœ(ì¥ë¥´, ì¹´ìš´íŠ¸)ë¡œ ë¦¬ìŠ¤íŠ¸ì— ë‹´ê³ , ì¹´ìš´íŠ¸ê°’ ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ
                favorite_genres = sorted(list(filter(lambda x: x[1], user_genres.items())), key=lambda x: x[1], reverse=True)

                # ì‚¬ìš©ìê°€ ë§ì´ ë³¸ ì¥ë¥´ ê¸°ë°˜ìœ¼ë¡œ ì¶”ì²œ ê°ë…ì˜ í•´ë‹¹ ì¥ë¥´ ì˜í™”ê°€ ìˆëŠ” ì§€ íƒìƒ‰ 
                for favorite_genre in favorite_genres:
                    if director_movies.filter(genre__contains=favorite_genre[0]).exists():
                        recommendable_movie = director_movies.filter(genre__contains=favorite_genre[0]).order_by('?').first()
                        break

                # ì¶”ì²œ ê°ë…ì˜ ì‘í’ˆ ì¤‘ì— ì‚¬ìš©ìê°€ ë³¸ ì¥ë¥´ê°€ ì—†ë‹¤ë©´ ê°ë…ì˜ ì „ì²´ ì‘í’ˆ ì¤‘ì—ì„œ ëœë¤ 
                else:
                    recommendable_movie = director_movies.order_by('?').first()

                serializer = MovieDetailSerializer(recommendable_movie)
                return Response(serializer.data)
```
    
</details>

    
<br>

### ğŸ”¸ ë¬¸ì œí•´ê²°

<details>
  <summary><h4>sqlite3 ë¦¬ìŠ¤íŠ¸ í•„ë“œ ì €ì¥í•˜ê¸°</h4></summary>
  
```python
# listê°ì²´ JSONí™”í•´ì„œ í•„ë“œì— ì €ì¥, ì¶”í›„ íŒŒì‹±í•´ì„œ ì‚¬ìš©
movie_genres_json = json.dumps(movie_genres)
```
    
</details>

<details>
  <summary><h4>í•œ ë²ˆì˜ ìš”ì²­ìœ¼ë¡œ 3 ê°œì˜ Open API ì‘ë‹µì„ DBì— ì €ì¥í•˜ê³ , 3 ê°€ì§€ë¥¼ êµ¬ë¶„í•´ì„œ ì‚¬ìš©ìì—ê²Œ ì‘ë‹µí•˜ê¸°</h4></summary>
  
ê° Open APIì˜ pathë¥¼ ë°˜ë³µë¬¸ìœ¼ë¡œ ëŒë©´ì„œ DBì— dataë¥¼ ì €ì¥í•˜ê³ , ì €ì¥ì´ ëë‚˜ë©´ DBì—ì„œ í•´ë‹¹ ì˜í™”ê°€ ê°€ì§„ ìœ ì¼í•œ ì†ì„±-ê°’ìœ¼ë¡œ ë°”ë¡œ ì°¾ì•„ë‚´ ë¹ˆ ë¦¬ìŠ¤íŠ¸ì— ì°¨ê³¡ì°¨ê³¡ ì±„ì›Œ ìµœì¢… ì‘ë‹µìœ¼ë¡œ ë³´ë‚¼ ë”•ì…”ë„ˆë¦¬ì— ì €ì¥í•œë‹¤.
    
```python
GET_MOVIES_PATHS_DICT = {
    'now_playing': '/movie/now_playing',
    'upcoming': '/movie/upcoming',
    'popular': '/movie/popular',
}

res = {}

for GET_MOVIES_PATH_NAME, GET_MOVIES_PATH in GET_MOVIES_PATHS_DICT.items():
    response_movies = requests.get(URL+GET_MOVIES_PATH, params=params)
    response_movies_json = response_movies.json()
    movies_data = response_movies_json['results']

    movies = []
    for movie_data in movies_data:

        serializer = MovieValidationSerializer(data=movie_data)
        if serializer.is_valid():
            if not Movie.objects.filter(title=movie_data['title']).exists():

                # ì¥ë¥´ id => í•œê¸€í™” ì‘ì—…
                genres_datas = movie_data['genre_ids']
                movie_genres = []
                for genre_data in genres_datas:
                    if genres_dict[genre_data]:
                        movie_genres.append(genres_dict[genre_data])

                # listê°ì²´ JSONí™”í•´ì„œ í•„ë“œì— ì €ì¥, ì¶”í›„ íŒŒì‹±í•´ì„œ ì‚¬ìš©
                movie_genres_json = json.dumps(movie_genres)

                # movieì˜ idê°’ìœ¼ë¡œ TMDB credits path ìš”ì²­í•´ì„œ ê°ë… ì´ë¦„ êµ¬í•˜ê¸°
                GET_CREDITS_PATH = f'/movie/{movie_data["id"]}/credits'
                response_credits = requests.get(URL+GET_CREDITS_PATH, params=params)
                response_credits_json = response_credits.json()

                # ì˜í™” ì œì‘ì ëª…ë‹¨ì¸ creditsì˜ crewê°’ì„ ë³€ìˆ˜í™” => crews_data
                crews_data = response_credits_json['crew']

                # ì§ì±…ì´ Directingì¸ crewì˜ ì´ë¦„ì„ director í•„ë“œì— ì €ì¥
                for crew_data in crews_data:
                    if crew_data['department'] == 'Directing':
                        movie_director = crew_data['name']
                        break

                serializer.save(genre=movie_genres_json, director=movie_director)

            movie = get_object_or_404(Movie, title=movie_data['title'])
            serializer = MovieDetailSerializer(movie)
            movies.append(serializer.data)

    res[GET_MOVIES_PATH_NAME] = movies

return Response(res)
```
    
</details>

    
<br>

### ğŸ”¸ ì•„ì‰¬ìš´ì 

<details>
  <summary><h4>ì»¤ë®¤ë‹ˆí‹° ì´ë¯¸ì§€ ì—…ë¡œë“œ ê¸°ëŠ¥</h4></summary>
  ì»¤ë®¤ë‹ˆí‹°ì— ê²Œì‹œê¸€ì„ ì˜¬ë¦´ ë•Œ ì˜¤ì§ ê¸€ë§Œ ì˜¬ë¼ê°ˆ ìˆ˜ ìˆì–´ì„œ ì´ë¯¸ì§€ë„ ì¶”ê°€í•´ì„œ ì¢€ ë” ë‹¤ì–‘í•œ ì •ë³´ë“¤ì´ ì˜¤ê°ˆ ìˆ˜ ìˆë„ë¡ ê°œì„ í•˜ë©´ ì¢‹ì„ ê²ƒ ê°™ë‹¤.
</details>

<details>
  <summary><h4>ë§íŒ”ë¡œìš° ë°©ëª…ë¡ ê¸°ëŠ¥</h4></summary>
  ì–´ëŠ ê¸°ê´€ì—ì„œ ì¡°ì‚¬í•œ ê²°ê³¼ì— ë”°ë¥´ë©´ ì‚¬ëŒë“¤ì€ SNSë‚˜ ì§€ì¸ìœ¼ë¡œë¶€í„° ì˜í™” ì¶”ì²œë°›ëŠ” ê²ƒì„ ì„ í˜¸í•œë‹¤ê³  í•œë‹¤. ì‚¬ìš©ìì˜ í”„ë¡œí•„ê³¼ íŒ”ë¡œìš° ê¸°ëŠ¥ì„ êµ¬í˜„í•œ ë§Œí¼, ì„œë¡œì˜ í”„ë¡œí•„ í˜ì´ì§€ì—ì„œ ë°©ëª…ë¡ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ë©´ ì‚¬ìš©ìë“¤ë¼ë¦¬ ì˜í™” ì¶”ì²œì„ ë³´ë‹¤ ì ê·¹ì ìœ¼ë¡œ ì´ëŒì–´ ë‚¼ ìˆ˜ ìˆì„ ê²ƒì´ë¼ ìƒê°ì´ ë“ ë‹¤.
</details>

<a href="#moodle-ë‹¹ì‹ ë§Œì˜-ì˜í™”-ê°ë…ì„-ì°¾ì•„ë³´ì„¸ìš”">âë§¨ ìœ„ë¡œ</a>
